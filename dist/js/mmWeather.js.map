{"version":3,"sources":["../../src/js/mmWeather.es2015.js"],"names":["mm","cssContainer","document","querySelector","mmHelper","mmWeather","Weather","data","name","weather","main","description","icon","temp","toFixed","getTime","d","dt_txt","replace","length","day","Date","getDay","getWeatherDay","url","foreCast","forecastUrl","apiUrl","updateInterval","coordParam","lat","lon","idParam","apiId","apiParamString","getWeather","setInterval","weathers","currentWeather","getJSON","err","console","log","list","forEach","value","index","city","push","displayWeather","weatherIconClass","iconCode","weatherType","type","toLowerCase","html","ul","getElementsByTagName","df","createDocumentFragment","append","i","find","capitalizeFirstLetter","createLi","parent","cssClass","text","li","createElement","t","createTextNode","classList","appendChild"],"mappings":"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","file":"mmWeather.js","sourcesContent":["(function(mm) { \n    var cssContainer = document.querySelector(\".mm-weather\");\n    var mmHelper = mm.mmWeather;\n\n    class Weather {\n        constructor(data) {\n            this.name = data.name  !== \"undefined\" ? data.name : \"\";\n            this.weather = data.weather[0].main;\n            this.description = data.weather[0].description;\n            this.icon = data.weather[0].icon;\n            this.temp = (data.main.temp - 273.15).toFixed(2);\n            this.getTime = function () {\n                var d = data.dt_txt !== \"undefined\" ? data.dt_txt.replace(/\\s/g, \"T\") :  \"\";\n                \n                if(d.length > 0) {\n                    day = new Date(d).getDay();\n                        return getWeatherDay(day);\n                } \n                \n                return 0;\n            }\n        }\n    }\n\n    var url = mmHelper.foreCast === true ? mmHelper.forecastUrl : mmHelper.apiUrl;\n    var updateInterval = !mmHelper.updateInterval || mmHelper.updateInterval === \"undefined\" ? 1080000  :  mmHelper.updateInterval; // Every 3 hours per default\n    var coordParam = \"lat=\" + mmHelper.lat + \"&lon=\" + mmHelper.lon;\n    var idParam = \"appid=\" + mmHelper.apiId;\n    var apiParamString = url + \"?\" + coordParam + \"&\" + idParam;\n\n    getWeather(apiParamString);\n\n    setInterval(function() {\n        getWeather(apiParamString);\n    }, updateInterval); \n\n\tfunction getWeather(url) {\n        var weathers = [];\n\t    var currentWeather = {};\n\n        mm.getJSON(url, function(err, data) {\n            if (err != null) {\n                console.log(\"Something went wrong: \" + err);\n            } else {\n                // Store weather forecast in array of Weather objects\n                if(mmHelper.foreCast === true) {\n                    data.list.forEach(function( value, index ) {\n                        if(index % 8 === 0) {\n                            value.name = data.city.name\n                            console.log(data.city.name);\n                            weathers.push(new Weather(value));\n                        }\n                    });\n\n                } else {\n                    currentWeather = new Weather(data);\n                }\n                \n                displayWeather(weathers, currentWeather);\n            }\n        });\n\t};\n\t\n\tfunction weatherIconClass(iconCode) {\n\t\tswitch(iconCode) {\n\t\t\tcase \"01d\":\n\t\t\tcase \"01n\":\n\t\t\t\treturn \"mm-weather-icon-sun\";\n\t\t\tcase \"02d\":\n\t\t\tcase \"02n\":\n\t\t\t\treturn \"mm-weather-icon-few-cloud\";\n\t\t\tcase \"03d\":\n\t\t\tcase \"03n\":\n\t\t\t\treturn \"mm-weather-icon-cloud\";\n\t\t\tcase \"04d\":\n\t\t\tcase \"04n\":\n\t\t\t\treturn \"mm-weather-icon-broken-cloud\";\n\t\t\tcase \"09d\":\n\t\t\tcase \"09n\":\n\t\t\t\treturn \"mm-weather-icon-shower-rain\";\n\t\t\tcase \"10d\":\n\t\t\tcase \"10n\":\n\t\t\t\treturn \"mm-weather-icon-rain\";\n\t\t\tcase \"11d\":\n\t\t\tcase \"11n\":\n\t\t\t\treturn \"mm-weather-icon-thunderstorm\";\n\t\t\tcase \"13d\":\n\t\t\tcase \"13n\":\n\t\t\t\treturn \"mm-weather-icon-snow\";\n\t\t\tcase \"50d\":\n\t\t\tcase \"50n\":\n\t\t\t\treturn \"mm-weather-icon-mist\";\n\t\t\tdefault:\n\t\t\t\treturn \"mm-weather-icon-sun\";\n\t\t}\n\t};\n\t\n\tfunction weatherType(type) {\n\t\tvar type = type.toLowerCase();\n\t\tswitch(type) {\n\t\t\tcase \"clear\":\n\t\t\tcase \"clear sky\": return \"klart\";\n\t\t\tcase \"few clouds\": return \"lite molnigt\";\n\t\t\tcase \"scattered clouds\": return \"molnigt\";\n\t\t\tcase \"broken clouds\": return \"mulet\";\n\t\t\tcase \"clouds\": return \"molnigt\";\n\t\t\tcase \"shower rain\": return \"täta regnskurar\";\n\t\t\tcase \"rain\": return \"regn\";\n\t\t\tcase \"thunderstorm\": return \"åskregn\";\n\t\t\tcase \"snow\": return \"snöfall\";\n\t\t\tcase \"mist\": return \"dimma\";\n            case \"clear\": return \"klart\";\n\t\t\tdefault:\n\t\t\t\treturn type;\n\t\t}\n\t};\n\t\n\tfunction getWeatherDay(day) {\n\t\tswitch(day) {\n\t\t\tcase 0: return \"Söndag\";\n\t\t\tcase 1: return \"Måndag\";\n\t\t\tcase 2: return \"Tisdag\";\n\t\t\tcase 3: return \"Onsdag\";\n\t\t\tcase 4: return \"Torsdag\";\n\t\t\tcase 5: return \"Fredag\";\n\t\t\tcase 6: return \"Lördag\";\n\t\t}\n\t}\n\t\n\t// Todo: translate currentWeather.description - http://openweathermap.org/weather-conditions\n\t\n\tfunction displayWeather(weathers, currentWeather) {\n\n\t\tcssContainer.html = \"\";\n        var ul = cssContainer.getElementsByTagName(\"ul\")[0];\n        var df = document.createDocumentFragment();\n\n\t\tif(mmHelper.foreCast === true) {\n\t\t\t\n\t\t\tcssContainer.append(\"<h1>\" + weathers[0].name + \"</h1>\");\n\t\t\t\t\t\n\t\t\tfor(var i = 0; i<3; i++) {\n                console.log(weathers[i]);\n\t\t\t\tul = cssContainer.append(\"<ul id=\\\"w\" + i + \"\\\"></ul>\").find(\"ul#w\" + i + \"\");\n\t\t\t\t\tul.append(\"<li>\" + weathers[i].getTime() + \" \" + weathers[i].temp + \" C°</li>\");\n\t\t\t\t\tul.append(\"<li><div class=\\\"\" + weatherIconClass(weathers[i].icon) + \" mm-weather-icon mm-right\\\"></div></li>\");\n\t\t\t\t\tul.append(\"<li class=\\\"mm-weather-type\\\">\" + weatherType(weathers[i].weather).capitalizeFirstLetter() + \"</li>\");\t\n\t\t\t\tcssContainer.append(\"<hr class=\\\"mm-clear\\\" />\");\n\t\t\t}\n\t\t} else {\n            createLi(cssContainer, \"\", currentWeather.name + \" \" + currentWeather.temp + \" C°\");\n            createLi(cssContainer, weatherIconClass(currentWeather.icon) + \" mm-weather-icon mm-right\", currentWeather.name + \" \" + currentWeather.temp + \" C°\");\n            createLi(cssContainer, \"mm-weather-type\", weatherType(currentWeather.weather));\n\t\t\t\t// ul.append(\"<li>\" + currentWeather.name + \" \" + currentWeather.temp + \" C°</li>\");\n\t\t\t\t// ul.append(\"<li><div class=\\\"\" + weatherIconClass(currentWeather.icon) + \" mm-weather-icon mm-right\\\"></div></li>\");\n\t\t\t\t// ul.append(\"<li class=\\\"mm-weather-type\\\">\" + weatherType(currentWeather.weather).capitalizeFirstLetter() + \"</li>\");\n\t\t\t\t//\tul.append(\"<li class=\\\"mm-weather-descr\\\">\" + currentWeather.description + \"</li>\");\n\t\t}\n\t};\n\n    function createLi(parent, cssClass, text) {\n\n        var li = document.createElement(li);\n        var t = document.createTextNode(text);\n        li.classList = cssClass;\n\n        li.appendChild(t);            \n        parent.appendChild(li);\n\n    }\n\n}(mmHelper));"]}