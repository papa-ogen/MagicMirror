{"version":3,"sources":["../../src/js/mmWeather.es2015.js"],"names":["mm","cssContainer","document","querySelector","mmHelper","mmWeather","Weather","data","name","weather","main","description","icon","temp","toFixed","getTime","d","dt_txt","replace","length","day","Date","getDay","getWeatherDay","url","foreCast","forecastUrl","apiUrl","updateInterval","coordParam","lat","lon","idParam","apiId","apiParamString","getWeather","setInterval","weathers","currentWeather","getJSON","err","console","log","list","forEach","value","index","city","push","displayWeather","weatherIconClass","iconCode","weatherType","type","toLowerCase","h1","getElementsByTagName","h3","innerHTML","classList"],"mappings":"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","file":"mmWeather.js","sourcesContent":["(function(mm) { \r\n    var cssContainer = document.querySelector(\".mm-weather\");\r\n    var mmHelper = mm.mmWeather;\r\n\r\n    class Weather {\r\n        constructor(data) {\r\n            this.name = data.name  !== \"undefined\" ? data.name : \"\";\r\n            this.weather = data.weather[0].main;\r\n            this.description = data.weather[0].description;\r\n            this.icon = data.weather[0].icon;\r\n            this.temp = (data.main.temp - 273.15).toFixed(2);\r\n            this.getTime = function () {\r\n                var d = data.dt_txt !== \"undefined\" ? data.dt_txt.replace(/\\s/g, \"T\") :  \"\";\r\n                \r\n                if(d.length > 0) {\r\n                    day = new Date(d).getDay();\r\n                        return getWeatherDay(day);\r\n                } \r\n                \r\n                return 0;\r\n            }\r\n        }\r\n    }\r\n\r\n    var url = mmHelper.foreCast === true ? mmHelper.forecastUrl : mmHelper.apiUrl;\r\n    var updateInterval = !mmHelper.updateInterval || mmHelper.updateInterval === \"undefined\" ? 1080000  :  mmHelper.updateInterval; // Every 3 hours per default\r\n    var coordParam = \"lat=\" + mmHelper.lat + \"&lon=\" + mmHelper.lon;\r\n    var idParam = \"appid=\" + mmHelper.apiId;\r\n    var apiParamString = url + \"?\" + coordParam + \"&\" + idParam;\r\n\r\n    getWeather(apiParamString);\r\n\r\n    setInterval(function() {\r\n        getWeather(apiParamString);\r\n    }, updateInterval); \r\n\r\n\tfunction getWeather(url) {\r\n        var weathers = [];\r\n\t    var currentWeather = {};\r\n\r\n        mm.getJSON(url, function(err, data) {\r\n            if (err != null) {\r\n                console.log(\"Something went wrong: \" + err);\r\n            } else {\r\n                // Store weather forecast in array of Weather objects\r\n                if(mmHelper.foreCast === true) {\r\n                    data.list.forEach(function( value, index ) {\r\n                        if(index % 8 === 0) {\r\n                            value.name = data.city.name\r\n                            console.log(data.city.name);\r\n                            weathers.push(new Weather(value));\r\n                        }\r\n                    });\r\n\r\n                } else {\r\n                    currentWeather = new Weather(data);\r\n                }\r\n                \r\n                displayWeather(weathers, currentWeather);\r\n            }\r\n        });\r\n\t};\r\n\t\r\n\tfunction weatherIconClass(iconCode) {\r\n\t\tswitch(iconCode) {\r\n\t\t\tcase \"01d\":\r\n\t\t\tcase \"01n\":\r\n\t\t\t\treturn \"mm-weather-icon-sun\";\r\n\t\t\tcase \"02d\":\r\n\t\t\tcase \"02n\":\r\n\t\t\t\treturn \"mm-weather-icon-few-cloud\";\r\n\t\t\tcase \"03d\":\r\n\t\t\tcase \"03n\":\r\n\t\t\t\treturn \"mm-weather-icon-cloud\";\r\n\t\t\tcase \"04d\":\r\n\t\t\tcase \"04n\":\r\n\t\t\t\treturn \"mm-weather-icon-broken-cloud\";\r\n\t\t\tcase \"09d\":\r\n\t\t\tcase \"09n\":\r\n\t\t\t\treturn \"mm-weather-icon-shower-rain\";\r\n\t\t\tcase \"10d\":\r\n\t\t\tcase \"10n\":\r\n\t\t\t\treturn \"mm-weather-icon-rain\";\r\n\t\t\tcase \"11d\":\r\n\t\t\tcase \"11n\":\r\n\t\t\t\treturn \"mm-weather-icon-thunderstorm\";\r\n\t\t\tcase \"13d\":\r\n\t\t\tcase \"13n\":\r\n\t\t\t\treturn \"mm-weather-icon-snow\";\r\n\t\t\tcase \"50d\":\r\n\t\t\tcase \"50n\":\r\n\t\t\t\treturn \"mm-weather-icon-mist\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"mm-weather-icon-sun\";\r\n\t\t}\r\n\t};\r\n\t\r\n\tfunction weatherType(type) {\r\n\t\tvar type = type.toLowerCase();\r\n\t\tswitch(type) {\r\n\t\t\tcase \"clear\":\r\n\t\t\tcase \"clear sky\": return \"klart\";\r\n\t\t\tcase \"few clouds\": return \"lite molnigt\";\r\n\t\t\tcase \"scattered clouds\": return \"molnigt\";\r\n\t\t\tcase \"broken clouds\": return \"mulet\";\r\n\t\t\tcase \"clouds\": return \"molnigt\";\r\n\t\t\tcase \"shower rain\": return \"täta regnskurar\";\r\n\t\t\tcase \"rain\": return \"regn\";\r\n\t\t\tcase \"thunderstorm\": return \"åskregn\";\r\n\t\t\tcase \"snow\": return \"snöfall\";\r\n\t\t\tcase \"mist\": return \"dimma\";\r\n            case \"clear\": return \"klart\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn type;\r\n\t\t}\r\n\t};\r\n\t\r\n\tfunction getWeatherDay(day) {\r\n\t\tswitch(day) {\r\n\t\t\tcase 0: return \"Söndag\";\r\n\t\t\tcase 1: return \"Måndag\";\r\n\t\t\tcase 2: return \"Tisdag\";\r\n\t\t\tcase 3: return \"Onsdag\";\r\n\t\t\tcase 4: return \"Torsdag\";\r\n\t\t\tcase 5: return \"Fredag\";\r\n\t\t\tcase 6: return \"Lördag\";\r\n\t\t}\r\n\t}\r\n\t\r\n\t// Todo: translate currentWeather.description - http://openweathermap.org/weather-conditions\r\n\t\r\n\tfunction displayWeather(weathers, currentWeather) {\r\n\r\n        var h1 = cssContainer.getElementsByTagName(\"h1\")[0];\r\n\t\tvar icon = cssContainer.getElementsByTagName(\"i\")[0];\r\n\t\tvar h3 = cssContainer.getElementsByTagName(\"h3\")[0];\r\n\r\n\t\tif(mmHelper.foreCast === true) {\r\n\t\t\t// Todo:\t\t\t\r\n\t\t\t// cssContainer.append(\"<h1>\" + weathers[0].name + \"</h1>\");\r\n\t\t\t\t\t\r\n\t\t\t// for(var i = 0; i<3; i++) {\r\n            //     console.log(weathers[i]);\r\n\t\t\t// \tul = cssContainer.append(\"<ul id=\\\"w\" + i + \"\\\"></ul>\").find(\"ul#w\" + i + \"\");\r\n\t\t\t// \t\tul.append(\"<li>\" + weathers[i].getTime() + \" \" + weathers[i].temp + \" C°</li>\");\r\n\t\t\t// \t\tul.append(\"<li><div class=\\\"\" + weatherIconClass(weathers[i].icon) + \" mm-weather-icon mm-right\\\"></div></li>\");\r\n\t\t\t// \t\tul.append(\"<li class=\\\"mm-weather-type\\\">\" + weatherType(weathers[i].weather).capitalizeFirstLetter() + \"</li>\");\t\r\n\t\t\t// \tcssContainer.append(\"<hr class=\\\"mm-clear\\\" />\");\r\n\t\t\t// }\r\n\t\t} else {\r\n\t\t\th1.innerHTML = currentWeather.name + \" \" + currentWeather.temp + \" C°\";\r\n\t\t\ticon.classList = weatherIconClass(currentWeather.icon) + \" mm-weather-icon\";\r\n\t\t\th3 = weatherType(currentWeather.weather);\r\n\t\t}\r\n\t};\r\n}(mmHelper));"]}