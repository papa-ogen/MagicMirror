{"version":3,"sources":["../../src/js/mmWeather.es2015.js"],"names":["mm","cssContainer","document","querySelector","mmHelper","mmWeather","Weather","data","name","weather","main","description","icon","temp","toFixed","getTime","d","dt_txt","replace","day","length","Date","getDay","getWeatherDay","url","foreCast","forecastUrl","apiUrl","updateInterval","coordParam","lat","lon","idParam","apiKey","apiParamString","getWeather","setInterval","weathers","currentWeather","getJSON","err","console","log","list","forEach","value","index","city","push","displayWeather","weatherIconClass","iconCode","weatherType","type","_type","toLowerCase","h1","getElementsByTagName","h3","df","createDocumentFragment","divRow","divCol","divBox","boxH2","boxI","boxH3","innerHTML","_createElement","text","classList","i","appendChild","capitalizeFirstLetter"],"mappings":"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","file":"mmWeather.js","sourcesContent":["// Todo: translate currentWeather.description - http://openweathermap.org/weather-conditions\n\n(function(mm) { \n    let cssContainer = document.querySelector(\".mm-weather\");\n    let mmHelper = mm.mmWeather;\n\n    class Weather {\n        constructor(data) {\n            this.name = data.name  !== \"undefined\" ? data.name : \"\";\n            this.weather = data.weather[0].main;\n            this.description = data.weather[0].description;\n            this.icon = data.weather[0].icon;\n            this.temp = (data.main.temp - 273.15).toFixed(1);\n            this.getTime = function () {\n                let d = data.dt_txt !== \"undefined\" ? data.dt_txt.replace(/\\s/g, \"T\") :  \"\";\n                let day;\n\n                if(d.length > 0) {\n                    day = new Date(d).getDay();\n                        return getWeatherDay(day);\n                } \n                \n                return 0;\n            }\n        }\n    }\n\n    let url = mmHelper.foreCast === true ? mmHelper.forecastUrl : mmHelper.apiUrl;\n    let updateInterval = !mmHelper.updateInterval || mmHelper.updateInterval === \"undefined\" ? 1080000  :  mmHelper.updateInterval; // Every 3 hours per default\n    let coordParam = \"lat=\" + mmHelper.lat + \"&lon=\" + mmHelper.lon;\n    let idParam = \"appid=\" + mmHelper.apiKey;\n    let apiParamString = url + \"?\" + coordParam + \"&\" + idParam;\n\n    getWeather(apiParamString);\n\n    setInterval(function() {\n        getWeather(apiParamString);\n    }, updateInterval); \n\n\tfunction getWeather(url) {\n        let weathers = [];\n\t    let currentWeather = {};\n\n        mm.getJSON(url, function(err, data) {\n            if (err != null) {\n                console.log(\"Something went wrong: \" + err);\n            } else {\n                // Store weather forecast in array of Weather objects\n                if(mmHelper.foreCast === true) {\n                    data.list.forEach(function( value, index ) {\n                        if(index % 8 === 0) {\n                            value.name = data.city.name\n                            weathers.push(new Weather(value));\n                        }\n                    });\n\n                } else {\n                    currentWeather = new Weather(data);\n                }\n                \n                displayWeather(weathers, currentWeather);\n            }\n        });\n\t};\n\t\n\tfunction weatherIconClass(iconCode) {\n\t\tswitch(iconCode) {\n\t\t\tcase \"01d\":\n\t\t\tcase \"01n\":\n\t\t\t\treturn \"mm-weather-icon-sun\";\n\t\t\tcase \"02d\":\n\t\t\tcase \"02n\":\n\t\t\t\treturn \"mm-weather-icon-few-cloud\";\n\t\t\tcase \"03d\":\n\t\t\tcase \"03n\":\n\t\t\t\treturn \"mm-weather-icon-cloud\";\n\t\t\tcase \"04d\":\n\t\t\tcase \"04n\":\n\t\t\t\treturn \"mm-weather-icon-broken-cloud\";\n\t\t\tcase \"09d\":\n\t\t\tcase \"09n\":\n\t\t\t\treturn \"mm-weather-icon-shower-rain\";\n\t\t\tcase \"10d\":\n\t\t\tcase \"10n\":\n\t\t\t\treturn \"mm-weather-icon-rain\";\n\t\t\tcase \"11d\":\n\t\t\tcase \"11n\":\n\t\t\t\treturn \"mm-weather-icon-thunderstorm\";\n\t\t\tcase \"13d\":\n\t\t\tcase \"13n\":\n\t\t\t\treturn \"mm-weather-icon-snow\";\n\t\t\tcase \"50d\":\n\t\t\tcase \"50n\":\n\t\t\t\treturn \"mm-weather-icon-mist\";\n\t\t\tdefault:\n\t\t\t\treturn \"mm-weather-icon-sun\";\n\t\t}\n\t};\n\t\n\tfunction weatherType(type) {\n\t\tlet _type = type.toLowerCase();\n\t\tswitch(_type) {\n\t\t\tcase \"clear\":\n\t\t\tcase \"clear sky\": return \"klart\";\n\t\t\tcase \"few clouds\": return \"lite molnigt\";\n\t\t\tcase \"scattered clouds\": return \"molnigt\";\n\t\t\tcase \"broken clouds\": return \"mulet\";\n\t\t\tcase \"clouds\": return \"molnigt\";\n\t\t\tcase \"shower rain\": return \"täta regnskurar\";\n\t\t\tcase \"rain\": return \"regn\";\n\t\t\tcase \"thunderstorm\": return \"åskregn\";\n\t\t\tcase \"snow\": return \"snöfall\";\n\t\t\tcase \"mist\": return \"dimma\";\n            case \"clear\": return \"klart\";\n\t\t\tdefault:\n\t\t\t\treturn _type;\n\t\t}\n\t};\n\t\n\tfunction getWeatherDay(day) {\n\t\tswitch(day) {\n\t\t\tcase 0: return \"Söndag\";\n\t\t\tcase 1: return \"Måndag\";\n\t\t\tcase 2: return \"Tisdag\";\n\t\t\tcase 3: return \"Onsdag\";\n\t\t\tcase 4: return \"Torsdag\";\n\t\t\tcase 5: return \"Fredag\";\n\t\t\tcase 6: return \"Lördag\";\n\t\t}\n\t}\n\t\n\tfunction displayWeather(weathers, currentWeather) {\n\n        let h1 = cssContainer.getElementsByTagName(\"h1\")[0];\n\t\tlet icon = cssContainer.getElementsByTagName(\"i\")[0];\n\t\tlet h3 = cssContainer.getElementsByTagName(\"h3\")[0];\n\n\t\tif(mmHelper.foreCast === true) {\n\t\t\tlet df = document.createDocumentFragment();\n\t\t\tlet divRow, divCol, divBox, boxH2, boxI, boxH3;\n\n\t\t\tcssContainer.innerHTML = \"\";\n\n\t\t\th1 = mm._createElement(\"h1\", { \n\t\t\t\ttext: weathers[0].name\n\t\t\t}, cssContainer);\n\n\t\t\tdivRow = mm._createElement(\"div\", { \n\t\t\t\tclassList: \"row center-xs\"\n\t\t\t}, df);\n\n\t\t\tfor(var i = 0; i<3; i++) {\n\t\t\t\tdivCol = mm._createElement(\"div\", { \n\t\t\t\t\tclassList: \"col-xs-12 col-lg\"\n\t\t\t\t}, divRow);\n\n\t\t\t\tdivBox = mm._createElement(\"div\", { \n\t\t\t\t\tclassList: \"box\"\t\t\t\t}, divCol);\n\n\t\t\t\tboxH2 = mm._createElement(\"h2\", {\n\t\t\t\t\ttext: weathers[i].getTime() + \" \" + weathers[i].temp + \" C°\"\n\t\t\t\t}, divBox);\n\n\t\t\t\tboxI = mm._createElement(\"i\", {\n\t\t\t\t\tclassList: weatherIconClass(weathers[i].icon) + \" mm-weather-icon\"\n\t\t\t\t}, divBox);\n\n\t\t\t\tboxH3 = mm._createElement(\"h3\", {\n\t\t\t\t\ttext: weatherType(weathers[i].weather)\n\t\t\t\t}, divBox);\n\t\t\t}\n\n\t\t\tcssContainer.appendChild(df);\n\n\t\t} else {\n\t\t\th1.innerHTML = currentWeather.name + \" \" + currentWeather.temp + \" C°\";\n\t\t\ticon.classList = weatherIconClass(currentWeather.icon) + \" mm-weather-icon\";\n\t\t\th3.innerHTML = weatherType(currentWeather.weather).capitalizeFirstLetter();\n\t\t}\n\t}\n}(mmHelper));"]}